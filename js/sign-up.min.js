document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("username"),t=document.getElementById("email"),n=document.getElementById("password"),a=document.getElementById("confirmPassword"),s=document.getElementById("tos"),d=document.getElementById("signUpBtn"),i=()=>{const i=e.value.trim(),o=t.value.trim(),c=n.value,r=a.value,l=s.checked;(e=>/^[a-zA-Z0-9_]{3,20}$/.test(e))(i)&&(e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(e).toLowerCase()))(o)&&c.length>=6&&c===r&&l?(d.classList.remove("disabled-btn"),d.disabled=!1):(d.classList.add("disabled-btn"),d.disabled=!0)};e.addEventListener("input",i),t.addEventListener("input",i),n.addEventListener("input",i),a.addEventListener("input",i),s.addEventListener("change",i),d.addEventListener("click",(async()=>{const s=e.value.trim(),i=t.value.trim(),o=n.value,c=a.value;d.disabled=!0,d.textContent="CREATING ACCOUNT...";try{const e=await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({username:s,email:i,password:o,confirmPassword:c})}),t=await e.json();if(e.ok&&t.success)alert("Account created successfully! Welcome to SpiceScript!"),window.location.href="/catalog";else{const e=t.message||"Sign up failed. Please try again.";alert(e),d.disabled=!1,d.textContent="CREATE ACCOUNT"}}catch(e){console.error("Sign up error:",e),alert("Network error. Please check your connection and try again."),d.disabled=!1,d.textContent="CREATE ACCOUNT"}}))}));