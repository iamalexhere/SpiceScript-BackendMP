document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("email"),t=document.getElementById("password"),n=document.getElementById("signInBtn"),a=()=>{const a=e.value.trim(),s=t.value;a&&s?(n.classList.remove("disabled-btn"),n.disabled=!1):(n.classList.add("disabled-btn"),n.disabled=!0)};e.addEventListener("input",a),t.addEventListener("input",a),n.addEventListener("click",(async()=>{const a=e.value.trim(),s=t.value;n.disabled=!0,n.textContent="SIGNING IN...";try{const e=await fetch("/api/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:a,password:s})}),t=await e.json();if(e.ok&&t.success)alert(`Welcome back, ${t.user.username}!`),window.location.href="/catalog";else{const e=t.message||"Sign in failed. Please check your credentials.";alert(e),n.disabled=!1,n.textContent="LOG IN"}}catch(e){console.error("Sign in error:",e),alert("Network error. Please check your connection and try again."),n.disabled=!1,n.textContent="LOG IN"}})),t.addEventListener("keypress",(e=>{"Enter"!==e.key||n.disabled||n.click()}))}));